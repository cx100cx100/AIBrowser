<Window x:Class="AIBrowser.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="AIBrowser" Height="900" Width="1600"
        WindowStartupLocation="CenterScreen"
        WindowStyle="None"
ResizeMode="CanResize"
Background="{DynamicResource PageBg}"
        MouseLeftButtonDown="Window_MouseLeftButtonDown"
        Icon="AIBrowser.ico"
>

    <WindowChrome.WindowChrome>
        <WindowChrome 
            CaptionHeight="0"  
            ResizeBorderThickness="5"
            GlassFrameThickness="1"
            CornerRadius="0" />
    </WindowChrome.WindowChrome>

    <Window.Resources>
        <Style x:Key="IconButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Foreground" Value="{DynamicResource SidebarText}"/>
            <Setter Property="FontSize" Value="18"/>
            <Setter Property="FontFamily" Value="Segoe MDL2 Assets"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}" CornerRadius="8" Padding="10">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="#1A888888"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter Property="Background" Value="#33888888"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <Style x:Key="CaptionButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="{DynamicResource TopbarText}"/>
            <Setter Property="FontFamily" Value="Segoe MDL2 Assets"/>
            <Setter Property="FontSize" Value="10"/>

            <Setter Property="Width" Value="46"/>
            <Setter Property="Height" Value="32"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="VerticalAlignment" Value="Top"/>

            <Setter Property="WindowChrome.IsHitTestVisibleInChrome" Value="True"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="bd" Background="{TemplateBinding Background}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="bd" Property="Background" Value="#19888888"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="bd" Property="Background" Value="#33888888"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="CaptionCloseButtonStyle" TargetType="Button" BasedOn="{StaticResource CaptionButtonStyle}">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="bd" Background="{TemplateBinding Background}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="bd" Property="Background" Value="#E81123"/>
                                <Setter Property="Foreground" Value="White"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="bd" Property="Background" Value="#CC101D"/>
                                <Setter Property="Foreground" Value="White"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="42"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- 自绘顶栏（可拖拽区域 + 窗口按钮） -->
        <Border Grid.Row="0" Background="{DynamicResource TopbarBg}">
            <DockPanel LastChildFill="True">
                <!-- 左侧拖动区域 -->
                <Border Background="Transparent" DockPanel.Dock="Left" Width="200"
                    MouseLeftButtonDown="TitleBar_MouseLeftButtonDown">
                    <TextBlock Text=" " />
                </Border>

                <!-- 右侧窗口按钮 -->
                <StackPanel DockPanel.Dock="Right" Orientation="Horizontal" VerticalAlignment="Top">
                    <Button Style="{StaticResource CaptionButtonStyle}" Click="MinBtn_Click">
                        <TextBlock Text="&#xE921;"/>
                    </Button>

                    <Button Style="{StaticResource CaptionButtonStyle}" Click="MaxBtn_Click">
                        <TextBlock Text="&#xE922;"/>
                    </Button>

                    <Button Style="{StaticResource CaptionCloseButtonStyle}" Click="CloseBtn_Click">
                        <TextBlock Text="&#xE8BB;"/>
                    </Button>
                </StackPanel>

                <!-- 中间也作为拖动区域 -->
                <Border Background="Transparent"
                    MouseLeftButtonDown="TitleBar_MouseLeftButtonDown"/>
            </DockPanel>
        </Border>

        <!-- 主体：左侧栏 + 内容区 -->
        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="104"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <!-- 左侧导航栏 -->
            <Border Grid.Column="0" Background="{DynamicResource SidebarBg}">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <!-- 顶部 Logo 区（可选） -->
                    <Border Grid.Row="0" Height="70" Background="Transparent">
                        <TextBlock Text=" " />
                    </Border>

                    <!-- 标签列表 -->
                    <ListBox x:Name="TabList"
                         Grid.Row="1"
                         BorderThickness="0"
                         Background="Transparent"
                         ScrollViewer.VerticalScrollBarVisibility="Auto"
                         SelectionChanged="TabList_SelectionChanged"
                             ScrollViewer.HorizontalScrollBarVisibility="Disabled"
ScrollViewer.CanContentScroll="False"
HorizontalContentAlignment="Stretch"
>

                        <ListBox.ItemsPanel>
                            <ItemsPanelTemplate>
                                <StackPanel Orientation="Vertical"/>
                            </ItemsPanelTemplate>
                        </ListBox.ItemsPanel>

                        <ListBox.ItemContainerStyle>
                            <Style TargetType="ListBoxItem">
                                <Setter Property="FocusVisualStyle" Value="{x:Null}"/>
                                <Setter Property="Margin" Value="0,10,0,0"/>
                                <Setter Property="HorizontalAlignment" Value="Center"/>
                                <Setter Property="Padding" Value="0"/>
                                <Setter Property="HorizontalContentAlignment" Value="Center"/>
                                <Setter Property="VerticalContentAlignment" Value="Center"/>
                                <Setter Property="Background" Value="Transparent"/>
                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="ListBoxItem">
                                            <Border x:Name="Bd"
                            Width="80"
                            Height="84"
                            Background="{DynamicResource TabItemBg}"
                            BorderBrush="{DynamicResource TabItemBorder}"
                            BorderThickness="2"
                            CornerRadius="18"
                            ClipToBounds="True">
                                                <ContentPresenter HorizontalAlignment="Stretch"
                                          VerticalAlignment="Stretch"/>
                                            </Border>
                                            <ControlTemplate.Triggers>
                                                <Trigger Property="IsSelected" Value="True">
                                                    <Setter TargetName="Bd" Property="BorderBrush" Value="{DynamicResource Accent}"/>
                                                </Trigger>
                                                <Trigger Property="IsMouseOver" Value="True">
                                                    <Setter TargetName="Bd" Property="BorderBrush" Value="{DynamicResource TabItemHoverBorder}"/>
                                                </Trigger>
                                            </ControlTemplate.Triggers>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                            </Style>
                        </ListBox.ItemContainerStyle>




                        <ListBox.ItemTemplate>
                            <DataTemplate>
                                <Grid Margin="6,6">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="*"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>

                                    <Border Width="44" Height="44"
                    Background="{DynamicResource IconBg}"
                    CornerRadius="14"
                    HorizontalAlignment="Center"
                    VerticalAlignment="Center">
                                        <Image Source="{Binding IconPath, TargetNullValue={x:Null}}" 
                               Margin="8" 
                               Stretch="UniformToFill"
                               RenderOptions.BitmapScalingMode="HighQuality"/>
                                    </Border>

                                    <TextBlock Grid.Row="1"
                                           Margin="0,8,0,0"
                                           Text="{Binding DisplayTitle}"
                                           Foreground="{DynamicResource SidebarText}"
                                           FontSize="11"
                                           TextTrimming="CharacterEllipsis"
                                           HorizontalAlignment="Center"/>
                                </Grid>
                            </DataTemplate>
                        </ListBox.ItemTemplate>
                    </ListBox>

                    <!-- 底部功能区：刷新/设置放这里更像图（可选） -->
                    <StackPanel Grid.Row="2" Margin="12,12" Orientation="Vertical">
                        <Button Click="RefreshBtn_Click" 
            Style="{StaticResource IconButtonStyle}" 
            ToolTip="重置页面"
            Margin="0,0,0,8">
                            <TextBlock Text="&#xE72C;"/>
                        </Button>

                        <Button Click="SettingsBtn_Click" 
            Style="{StaticResource IconButtonStyle}"
            ToolTip="设置">
                            <TextBlock Text="&#xE713;"/>
                        </Button>
                    </StackPanel>
                </Grid>
            </Border>

            <!-- 右侧内容区：WebView2 容器 -->
            <Grid Grid.Column="1" Background="{DynamicResource PageBg}">
                <Grid Margin="14">
                    <Border Background="{DynamicResource TopbarBg}" CornerRadius="18"/>
                    <Grid x:Name="ContentHost" Margin="0" />
                </Grid>
            </Grid>
        </Grid>
    </Grid>

</Window>

